# 00. 如何运行.ps1脚本
运行 `.ps1` 文件（PowerShell 脚本文件）有多种方法，以下是一些常见的方法：

### 方法1：通过 PowerShell 控制台运行
1. **打开 PowerShell**：
   - 在 Windows 搜索栏中输入“PowerShell”。
   - 右键点击“Windows PowerShell”，选择“以管理员身份运行”。

2. **设置执行策略**：
   - 默认情况下，Windows 会限制运行未签名的脚本。你需要设置执行策略来允许运行脚本。
   - 在 PowerShell 中运行以下命令：
     ```powershell
     Set-ExecutionPolicy RemoteSigned
     ```
   - 系统会提示你确认，输入 `Y` 或 `A` 来确认。

3. **运行脚本**：
   - 导航到脚本所在的目录，例如：
     ```powershell
     cd C:\path\to\your\script
     ```
   - 运行脚本：
     ```powershell
     .\YourScript.ps1
     ```

### 方法2：通过文件关联运行
1. **设置文件关联**：
   - 右键点击 `.ps1` 文件，选择“打开方式”。
   - 选择“Windows PowerShell”或“Windows PowerShell ISE”（如果已安装）。
   - 勾选“始终使用此应用打开.ps1文件”。

2. **运行脚本**：
   - 双击 `.ps1` 文件即可运行。

### 方法3：通过命令行运行
1. **打开命令提示符**：
   - 在 Windows 搜索栏中输入“cmd”。
   - 右键点击“命令提示符”，选择“以管理员身份运行”。

2. **运行脚本**：
   - 使用 `powershell` 命令运行脚本，例如：
     ```cmd
     powershell -ExecutionPolicy Bypass -File C:\path\to\your\script\YourScript.ps1
     ```

### 方法4：通过 PowerShell ISE（集成脚本环境）运行
1. **打开 PowerShell ISE**：
   - 在 Windows 搜索栏中输入“PowerShell ISE”。
   - 打开 PowerShell ISE。

2. **打开脚本文件**：
   - 在 PowerShell ISE 中，点击“文件”->“打开”，选择你的 `.ps1` 文件。

3. **运行脚本**：
   - 点击工具栏上的“运行脚本”按钮（绿色三角形），或者按 `F5` 键。

### 方法5：通过 Visual Studio Code 运行
1. **安装 Visual Studio Code**：
   - 如果你还没有安装 Visual Studio Code，可以从 [Visual Studio Code 官网](https://code.visualstudio.com/) 下载并安装。

2. **安装 PowerShell 扩展**：
   - 打开 Visual Studio Code。
   - 点击左侧的扩展图标，搜索“PowerShell”并安装。

3. **打开脚本文件**：
   - 在 Visual Studio Code 中，点击“文件”->“打开文件”，选择你的 `.ps1` 文件。

4. **运行脚本**：
   - 打开终端（`Ctrl+``）。
   - 在终端中运行以下命令：
     ```powershell
     Set-ExecutionPolicy RemoteSigned
     ```
   - 运行脚本：
     ```powershell
     .\YourScript.ps1
     ```

### 方法6：通过任务计划程序运行
1. **打开任务计划程序**：
   - 在 Windows 搜索栏中输入“任务计划程序”并打开。

2. **创建新任务**：
   - 在任务计划程序中，点击“创建基本任务...”。
   - 按照向导的提示，设置任务的名称、触发器（例如，开机时、每天等）和操作（运行脚本）。
   - 在“操作”中，选择“启动程序”，在“程序/脚本”中输入 `powershell`，在“添加参数”中输入 `-ExecutionPolicy Bypass -File C:\path\to\your\script\YourScript.ps1`。

3. **保存任务**：
   - 完成向导后，任务会自动保存并按设置的时间运行。

### 方法7：通过快捷方式运行
1. **创建快捷方式**：
   - 右键点击桌面或开始菜单，选择“新建”->“快捷方式”。
   - 在“输入对象的位置”中输入以下命令：
     ```cmd
     powershell -ExecutionPolicy Bypass -File C:\path\to\your\script\YourScript.ps1
     ```
   - 点击“下一步”，输入快捷方式的名称，例如“运行脚本”。
   - 点击“完成”。

2. **运行脚本**：
   - 双击创建的快捷方式即可运行脚本。

### 注意事项
- **执行策略**：默认情况下，Windows 会限制运行未签名的脚本。通过 `Set-ExecutionPolicy` 命令可以设置执行策略，但请注意安全风险。
- **管理员权限**：某些脚本可能需要管理员权限才能正常运行，因此在运行脚本时可能需要以管理员身份打开 PowerShell 或命令提示符。

希望这些方法能帮助你顺利运行 `.ps1` 文件或 PowerShell 脚本！