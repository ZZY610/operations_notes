# 00. å¸¸ç”¨å‘½ä»¤

## 1. è¾“å…¥ä¸è¾“å‡º

PowerShell æä¾›äº†ä¸°å¯Œçš„è¾“å…¥ã€è¾“å‡ºå‘½ä»¤æ¥å¤„ç†æ•°æ®ã€æ–‡ä»¶ã€ç”¨æˆ·äº¤äº’ç­‰ã€‚æœ¬æ–‡è¯¦ç»†ä»‹ç» PowerShell ä¸­çš„ **è¾“å…¥ï¼ˆInputï¼‰** å’Œ **è¾“å‡ºï¼ˆOutputï¼‰** ç›¸å…³å‘½ä»¤ï¼Œå¹¶ç»™å‡ºç¤ºä¾‹ã€‚

---

### **1.1 è¾“å‡ºå‘½ä»¤ï¼ˆOutputï¼‰**
PowerShell æä¾›äº†ä¸€ç³»åˆ—ç”¨äº**è¾“å‡ºæ•°æ®åˆ°å±å¹•ã€æ–‡ä»¶ã€å˜é‡ç­‰**çš„å‘½ä»¤ï¼ŒåŒ…æ‹¬ï¼š
- `Write-Host`
- `Write-Output`
- `Write-Error`
- `Write-Warning`
- `Write-Debug`
- `Write-Verbose`
- `Out-File`
- `Out-Host`
- `Out-Null`
- `Out-GridView`

#### **1.1.1 Write-Hostï¼ˆç›´æ¥è¾“å‡ºåˆ°å±å¹•ï¼‰**
`Write-Host` ä¸»è¦ç”¨äºåœ¨**ç»ˆç«¯ç›´æ¥è¾“å‡ºä¿¡æ¯**ï¼Œä½†ä¸ä¼šä¼ é€’æ•°æ®åˆ°ç®¡é“ï¼ˆPipelineï¼‰ã€‚
```powershell
Write-Host "Hello, PowerShell!"
```
å¯ä»¥ä½¿ç”¨ `-ForegroundColor` å’Œ `-BackgroundColor` è®¾ç½®é¢œè‰²ï¼š
```powershell
Write-Host "è­¦å‘Š: æ“ä½œå¤±è´¥ï¼" -ForegroundColor Red -BackgroundColor Yellow
```
> `Write-Host` é€‚ç”¨äº**ç”¨æˆ·å¯è§ä¿¡æ¯**ï¼Œä½†**ä¸é€‚ç”¨äºè„šæœ¬ä¼ é€’æ•°æ®**ã€‚

---

#### **1.1.2 Write-Outputï¼ˆæ ‡å‡†è¾“å‡ºï¼Œå¯ä¼ é€’åˆ°ç®¡é“ï¼‰**
`Write-Output` å¯ä»¥**è¾“å‡ºæ•°æ®åˆ°ç®¡é“**ï¼Œç”¨äºè¿›ä¸€æ­¥å¤„ç†ã€‚
```powershell
Write-Output "è¿™æ˜¯ä¸€ä¸ªè¾“å‡º"
```
ç¤ºä¾‹ï¼šå°† `Write-Output` ç»“æœä¼ é€’ç»™å˜é‡
```powershell
$result = Write-Output "Hello, PowerShell!"
$result  # ä»ç„¶èƒ½æ‰“å°å‡º "Hello, PowerShell!"
```
ç¤ºä¾‹ï¼š`Write-Output` ç»“åˆç®¡é“
```powershell
Write-Output "Hello" | Out-File output.txt
```
> `Write-Output` **é€‚ç”¨äºè„šæœ¬æ•°æ®ä¼ é€’**ã€‚

---

#### **1.1.3 Write-Errorï¼ˆè¾“å‡ºé”™è¯¯ä¿¡æ¯ï¼‰**
`Write-Error` ç”¨äº**ç”Ÿæˆé”™è¯¯æ¶ˆæ¯**ï¼Œæ”¯æŒ `-Category` è¿›è¡Œé”™è¯¯åˆ†ç±»ï¼š
```powershell
Write-Error "æ–‡ä»¶æœªæ‰¾åˆ°ï¼"
```
ç¤ºä¾‹ï¼š
```powershell
Write-Error "æ— æ³•æ‰“å¼€æ–‡ä»¶" -Category ObjectNotFound
```
> `Write-Error` å¯ç”¨äºé”™è¯¯å¤„ç†ï¼Œä½†ä¸ä¼šç»ˆæ­¢è„šæœ¬æ‰§è¡Œï¼ˆé™¤é `$ErrorActionPreference="Stop"`ï¼‰ã€‚

---

#### **1.1.4 Write-Warningï¼ˆè¾“å‡ºè­¦å‘Šä¿¡æ¯ï¼‰**
`Write-Warning` ç”¨äº**è¾“å‡ºè­¦å‘Šä¿¡æ¯**ï¼Œä½†ä¸ä¼šä¸­æ–­è„šæœ¬ï¼š
```powershell
Write-Warning "ç£ç›˜ç©ºé—´ä¸è¶³ï¼"
```

---

#### **1.1.5 Write-Debugï¼ˆè°ƒè¯•ä¿¡æ¯ï¼‰**
`Write-Debug` ä»…åœ¨ `$DebugPreference = "Continue"` æ—¶è¾“å‡ºï¼š
```powershell
$DebugPreference = "Continue"
Write-Debug "è°ƒè¯•æ¨¡å¼å¼€å¯..."
```

---

#### **1.1.6 Write-Verboseï¼ˆè¯¦ç»†æ—¥å¿—ï¼‰**
`Write-Verbose` ä»…åœ¨ `$VerbosePreference = "Continue"` æ—¶è¾“å‡ºï¼š
```powershell
$VerbosePreference = "Continue"
Write-Verbose "æ­£åœ¨æ‰§è¡Œä»»åŠ¡..."
```
> é€‚ç”¨äº**è°ƒè¯•å’Œæ—¥å¿—è®°å½•**ã€‚

---

#### **1.1.7 Out-Fileï¼ˆè¾“å‡ºåˆ°æ–‡ä»¶ï¼‰**
`Out-File` ç”¨äº**å°†æ•°æ®å†™å…¥æ–‡ä»¶**ï¼š
```powershell
"Hello, PowerShell!" | Out-File "output.txt"
```
> **æ³¨æ„**ï¼šé»˜è®¤æƒ…å†µä¸‹ `Out-File` **ä¼šä½¿ç”¨ UTF-16**ï¼Œå¦‚æœéœ€è¦ UTF-8ï¼Œå¯ä»¥ä½¿ç”¨ï¼š
```powershell
"Hello, UTF-8!" | Out-File "output.txt" -Encoding utf8
```

---

#### **1.1.8 Out-Hostï¼ˆè¾“å‡ºåˆ°ç»ˆç«¯ï¼‰**
`Out-Host` **æ˜¾å¼è¾“å‡ºåˆ°ç»ˆç«¯**ï¼š
```powershell
Get-Process | Out-Host
```
> é€‚ç”¨äº**ç¡®ä¿è¾“å‡ºåˆ°ç»ˆç«¯ï¼Œè€Œä¸ä¼ é€’åˆ°ç®¡é“**ã€‚

---

#### **1.1.9 Out-Nullï¼ˆä¸¢å¼ƒè¾“å‡ºï¼‰**
`Out-Null` å¯ç”¨äº**ä¸¢å¼ƒå‘½ä»¤çš„è¾“å‡º**ï¼Œé¿å…åœ¨ç»ˆç«¯æ˜¾ç¤ºï¼š
```powershell
Get-Process | Out-Null
```
> é€‚ç”¨äº**éšè—ä¸å¿…è¦çš„è¾“å‡º**ã€‚

---

#### **1.1.10 Out-GridViewï¼ˆGUI è¡¨æ ¼æŸ¥çœ‹ï¼‰**
`Out-GridView` åœ¨ Windows ä¸‹ä¼š**å¼¹å‡º GUI çª—å£**ï¼š
```powershell
Get-Process | Out-GridView -Title "è¿›ç¨‹åˆ—è¡¨"
```
> é€‚ç”¨äº**å¯è§†åŒ–æ•°æ®è¡¨æ ¼**ã€‚

---

### **1.2 è¾“å…¥å‘½ä»¤ï¼ˆInputï¼‰**
PowerShell æä¾›å¤šç§æ–¹å¼æ¥æ”¶ç”¨æˆ·è¾“å…¥ï¼š
- `Read-Host`
- `$args`
- `Param`
- `$input`

---

#### **1.2.1 Read-Hostï¼ˆè·å–ç”¨æˆ·è¾“å…¥ï¼‰**
`Read-Host` ç”¨äº**ä»æ§åˆ¶å°è·å–ç”¨æˆ·è¾“å…¥**ï¼š
```powershell
$name = Read-Host "è¯·è¾“å…¥ä½ çš„åå­—"
Write-Host "ä½ å¥½, $name!"
```
ç¤ºä¾‹ï¼šè¾“å…¥å¯†ç ï¼ˆéšè—è¾“å…¥ï¼‰
```powershell
$password = Read-Host "è¯·è¾“å…¥å¯†ç " -AsSecureString
```
> `-AsSecureString` è®©è¾“å…¥å†…å®¹ä¸å¯è§ï¼Œé€‚ç”¨äº**å¯†ç è¾“å…¥**ã€‚

---

#### **1.2.2 $argsï¼ˆä¼ é€’å‚æ•°ç»™è„šæœ¬ï¼‰**
PowerShell å…è®¸è„šæœ¬æ¥å—**ä½ç½®å‚æ•°**ï¼Œä½¿ç”¨ `$args` è®¿é—®ï¼š
```powershell
# åˆ›å»º test.ps1 æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š
Write-Host "å‚æ•° 1: $($args[0])"
Write-Host "å‚æ•° 2: $($args[1])"
```
è¿è¡Œï¼š
```powershell
powershell -File test.ps1 Hello World
```
è¾“å‡ºï¼š
```
å‚æ•° 1: Hello
å‚æ•° 2: World
```
> `$args` é€‚ç”¨äº**ç®€å•å‚æ•°ä¼ é€’**ï¼Œä½†ä¸å¦‚ `Param` æ–¹å¼çµæ´»ã€‚

---

#### **1.2.3 Paramï¼ˆå®šä¹‰å‚æ•°ï¼‰**
æ›´æ¨èä½¿ç”¨ `Param` å®šä¹‰å‚æ•°ï¼š
```powershell
param (
    [string]$name,
    [int]$age
)

Write-Host "å§“å: $name, å¹´é¾„: $age"
```
è¿è¡Œï¼š
```powershell
powershell -File test.ps1 -name "Tom" -age 25
```
> `param` æä¾›æ›´æ¸…æ™°çš„å‚æ•°ç»“æ„ï¼Œé€‚ç”¨äº**å¤æ‚è„šæœ¬**ã€‚

---

#### **1.2.4 $inputï¼ˆå¤„ç†ç®¡é“è¾“å…¥ï¼‰**
`$input` å¤„ç†ç®¡é“æ•°æ®ï¼š
```powershell
# test.ps1
$input | ForEach-Object { Write-Host "æ¥æ”¶åˆ°: $_" }
```
è¿è¡Œï¼š
```powershell
"Apple", "Banana" | powershell -File test.ps1
```
è¾“å‡ºï¼š
```
æ¥æ”¶åˆ°: Apple
æ¥æ”¶åˆ°: Banana
```
> é€‚ç”¨äº**å¤„ç†ç®¡é“ä¼ å…¥çš„æ•°æ®**ã€‚

---

### **3. ç»¼åˆç¤ºä¾‹**
ä¸‹é¢æ˜¯ä¸€ä¸ªç»¼åˆç¤ºä¾‹ï¼š
```powershell
param (
    [string]$name = "ç”¨æˆ·",
    [int]$age
)

# ç”¨æˆ·è¾“å…¥
if (-not $age) {
    $age = Read-Host "è¯·è¾“å…¥ä½ çš„å¹´é¾„"
}

Write-Output "ä½ å¥½, $name! ä½  $age å²äº†ã€‚" | Out-File "userinfo.txt"

Write-Host "ä¿¡æ¯å·²ä¿å­˜åˆ° userinfo.txt" -ForegroundColor Green
```
è¿è¡Œï¼š
```powershell
powershell -File script.ps1 -name Alice
```
ç„¶åæ‰‹åŠ¨è¾“å…¥å¹´é¾„ï¼Œæœ€ç»ˆä¿¡æ¯å°†å†™å…¥ `userinfo.txt`ã€‚

### 4. è¡¨æ ¼è¯´æ˜
| **å‘½ä»¤** | **ä½œç”¨** |
|----------|----------|
| `Write-Host` | ç›´æ¥è¾“å‡ºåˆ°ç»ˆç«¯ï¼Œä¸ä¼ é€’åˆ°ç®¡é“ |
| `Write-Output` | è¾“å‡ºæ•°æ®ï¼Œå¯ä¼ é€’åˆ°ç®¡é“ |
| `Write-Error` | ç”Ÿæˆé”™è¯¯æ¶ˆæ¯ |
| `Write-Warning` | è¾“å‡ºè­¦å‘Šä¿¡æ¯ |
| `Write-Debug` | è°ƒè¯•ä¿¡æ¯ï¼ˆéœ€è®¾ç½® `$DebugPreference`ï¼‰ |
| `Write-Verbose` | è¯¦ç»†æ—¥å¿—ï¼ˆéœ€è®¾ç½® `$VerbosePreference`ï¼‰ |
| `Out-File` | å°†è¾“å‡ºå†™å…¥æ–‡ä»¶ |
| `Read-Host` | è·å–ç”¨æˆ·è¾“å…¥ |
| `$args` | å¤„ç†ä½ç½®å‚æ•° |
| `param` | å®šä¹‰å‘½ä»¤è¡Œå‚æ•° |
| `$input` | å¤„ç†ç®¡é“è¾“å…¥ |

æŒæ¡è¿™äº›å‘½ä»¤ï¼Œå¯ä»¥æ›´é«˜æ•ˆåœ°è¿›è¡Œ PowerShell **è¾“å…¥è¾“å‡ºå¤„ç†** ğŸš€ã€‚

## 2. æ•°æ®æ“ä½œä¸ç®¡é“

### 2.1 é€‰æ‹©ä¸è¿‡æ»¤

#### 1. where-object è¿‡æ»¤å¯¹è±¡
- ç”¨é€”ï¼šåˆ›å»ºæ§åˆ¶å“ªäº›å¯¹è±¡æ²¿ç€å‘½ä»¤ç®¡é“ä¼ é€’çš„ç­›é€‰å™¨ã€‚
- Where-Object cmdlet ä»ä¼ é€’ç»™å®ƒçš„å¯¹è±¡é›†åˆä¸­é€‰æ‹©å¯¹è±¡ã€‚å®ƒä½¿ç”¨è„šæœ¬å—ä½œä¸ºç­›é€‰å™¨ï¼Œå¹¶å¯¹æ¯ä¸ªå¯¹è±¡çš„è„šæœ¬å—è¿›è¡Œè¯„ä¼°ã€‚å¦‚æœè¯„ä¼°ç»“æœä¸ºâ€œTrueâ€ï¼Œåˆ™è¿”å›è¯¥å¯¹è±¡ã€‚å¦‚æœè¯„ä¼°ç»“æœä¸æ˜¯â€œTrueâ€ï¼Œåˆ™å¿½ç•¥è¯¥å¯¹è±¡ã€‚

```powershell
# è·å–æ­£åœ¨è¿è¡Œçš„æ‰€æœ‰æœåŠ¡åç§°

Get-Service | Where-Object { $_.Status -eq "Running" } | Select-Object Name, DisplayName

# è·å–æœ¬æœºæ‰€æœ‰IPV4ç½‘ç»œåœ°å€
Get-NetIPAddress | Where-Object{$_.AddressFamily -eq "IPV4"} |Select-Object IPAddress,InterfaceAlias
```


#### 2. Select-Object é€‰æ‹©å±æ€§ ç»“æœç­›é€‰
- ç”¨é€”ï¼š`Select-Object` å…è®¸ä½ é€‰æ‹©å¯¹è±¡çš„ç‰¹å®šå±æ€§æˆ–éƒ¨åˆ†å†…å®¹ã€‚

**è¯­æ³•**:
```powershell
Select-Object [-Property] <string[]>
```

**ç¤ºä¾‹**:
```powershell
Get-Process | Select-Object Name, Id
```
è¿™ä¸ªå‘½ä»¤è·å–å½“å‰ç³»ç»Ÿä¸­çš„è¿›ç¨‹ï¼Œå¹¶é€‰æ‹©æ˜¾ç¤ºè¿›ç¨‹çš„ `Name` å’Œ `Id` å±æ€§ã€‚

#### 3. Sort-Object å¯¹è±¡æ’åº
- ç”¨é€”ï¼šå¯¹å¯¹è±¡è¿›è¡Œæ’åºã€‚

**è¯­æ³•**:
```powershell
Sort-Object [-Property] <string>
```

**ç¤ºä¾‹**:
```powershell
Get-Process | Sort-Object CPU
```
è¿™å°†æŒ‰ç…§ CPU ä½¿ç”¨é‡å¯¹è¿›ç¨‹è¿›è¡Œæ’åºã€‚


#### 4. Measure-Object æ•°æ®ç»Ÿè®¡ 
`Measure-Object` æ˜¯ PowerShell ä¸­ç”¨äºè®¡ç®—å’Œåˆ†ææ•°æ®å¯¹è±¡çš„å‘½ä»¤ã€‚å®ƒå¯ä»¥å¯¹å¯¹è±¡é›†åˆæ‰§è¡Œå¤šç§ç»Ÿè®¡æ“ä½œï¼Œå¦‚è®¡æ•°ã€æ±‚å’Œã€å¹³å‡å€¼ã€æœ€å¤§å€¼å’Œæœ€å°å€¼ç­‰ã€‚

`Measure-Object` çš„ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š
- è®¡ç®—å¯¹è±¡çš„æ•°é‡ï¼ˆCountï¼‰
- å¯¹æ•°å­—è¿›è¡Œæ±‚å’Œï¼ˆSumï¼‰
- è®¡ç®—æ•°å­—çš„å¹³å‡å€¼ï¼ˆAverageï¼‰
- æ‰¾åˆ°æœ€å¤§å€¼ï¼ˆMaximumï¼‰å’Œæœ€å°å€¼ï¼ˆMinimumï¼‰

å¸¸ç”¨å‚æ•°ï¼š
- `-Property`ï¼šæŒ‡å®šå¯¹è±¡çš„å±æ€§ã€‚
- `-Sum`ï¼šè®¡ç®—å±æ€§çš„æ€»å’Œã€‚
- `-Average`ï¼šè®¡ç®—å±æ€§çš„å¹³å‡å€¼ã€‚
- `-Minimum`ï¼šæ‰¾åˆ°å±æ€§çš„æœ€å°å€¼ã€‚
- `-Maximum`ï¼šæ‰¾åˆ°å±æ€§çš„æœ€å¤§å€¼ã€‚
- `-Line`ï¼šè®¡ç®—æ–‡æœ¬çš„è¡Œæ•°ã€‚
- `-Word`ï¼šè®¡ç®—æ–‡æœ¬çš„å•è¯æ•°ã€‚
- `-Character`ï¼šè®¡ç®—æ–‡æœ¬çš„å­—ç¬¦æ•°ã€‚

##### 1. è®¡ç®—æ•°ç»„ä¸­çš„å…ƒç´ æ•°é‡

æœ€ç®€å•çš„ä¾‹å­æ˜¯è®¡ç®—å¯¹è±¡çš„æ•°é‡ï¼š

```powershell
$numbers = 1..100
$numbers | Measure-Object
```

è¾“å‡ºï¼š

```plaintext
Count    : 100
```

##### 2. è®¡ç®—æ•°ç»„çš„æ€»å’Œã€å¹³å‡å€¼ã€æœ€å¤§å€¼å’Œæœ€å°å€¼

ä½ å¯ä»¥å¯¹æ•°å­—æ•°ç»„è¿›è¡Œæ›´å¤šç»Ÿè®¡åˆ†æï¼Œå¦‚æ±‚å’Œã€å¹³å‡å€¼ç­‰ï¼š

```powershell
$numbers = 1..100
$numbers | Measure-Object -Sum -Average -Maximum -Minimum
```

è¾“å‡ºï¼š

```plaintext
Count    : 100
Average  : 50.5
Sum      : 5050
Maximum  : 100
Minimum  : 1
```

åœ¨ PowerShell ä¸­ï¼Œ`Measure-Object` çš„ `-InputObject` å‚æ•°å¹¶ä¸èƒ½ç›´æ¥å¤„ç†æ•°ç»„ï¼Œå› ä¸º `-InputObject` å‚æ•°æœŸæœ›æ¥æ”¶ä¸€ä¸ªå¯ä»¥è¢«ç›´æ¥åº¦é‡çš„å•ä¸€å¯¹è±¡ï¼Œè€Œæ•°ç»„ï¼ˆ`System.Object[]`ï¼‰æ˜¯ä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨ `Measure-Object` è¿›è¡Œè®¡ç®—ã€‚å¦‚æœä½ æƒ³å¯¹æ•°ç»„ä¸­çš„æ•°å­—è¿›è¡Œåº¦é‡ï¼Œéœ€è¦é€šè¿‡ç®¡é“ (`|`) å°†æ•°ç»„ä¸­çš„å…ƒç´ ä¼ é€’ç»™ `Measure-Object`ã€‚

###### é”™è¯¯ç¤ºä¾‹

```powershell
Measure-Object -InputObject $y -Sum
```

æŠ¥é”™ `Input object "System.Object[]" is not numeric` æ˜¯å› ä¸º `$y` æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè€Œ `Measure-Object` æœŸæœ›æ¥æ”¶çš„æ˜¯å•ä¸€æ•°å­—ç±»å‹çš„å¯¹è±¡ï¼ˆå¦‚ `Int32`ã€`Double` ç­‰ï¼‰ã€‚

`-InputObject` å‚æ•°ç”¨æ¥å¤„ç†å•ä¸€å¯¹è±¡ï¼Œé€‚åˆå¤„ç†å•ä¸ªå­—ç¬¦ä¸²ã€å•ä¸ªæ•°å­—ç­‰ï¼Œè€Œæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éœ€è¦é€ä¸ªä¼ é€’åˆ° `Measure-Object` è¿›è¡Œå¤„ç†ã€‚

###### æ­£ç¡®çš„ç”¨æ³•

è¦å¯¹æ•°ç»„ä¸­çš„æ•°å­—è¿›è¡Œåº¦é‡ï¼Œåº”è¯¥é€šè¿‡ç®¡é“æŠŠæ•°ç»„çš„å…ƒç´ ä¼ é€’ç»™ `Measure-Object`ï¼Œå¦‚ä¸‹ï¼š

```powershell
$y = @(1, 4, 5, 7)

$y | Measure-Object -Sum
```

`Measure-Object` æœŸæœ›å¤„ç†ç®¡é“ä¼ é€’çš„å¯¹è±¡é›†åˆã€‚å¯¹äºæ•°ç»„è¿™ç§å¤æ‚å¯¹è±¡ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨ `-InputObject`ï¼Œéœ€è¦é€šè¿‡ç®¡é“æŠŠæ•°ç»„çš„å…ƒç´ ä¼ é€’ç»™ `Measure-Object` æ¥è¿›è¡Œåº¦é‡ã€‚

##### 3. é’ˆå¯¹å¯¹è±¡çš„ç‰¹å®šå±æ€§è¿›è¡Œæµ‹é‡

å¦‚æœä½ æœ‰ä¸€ä¸ªå¯¹è±¡é›†åˆï¼Œå¹¶å¸Œæœ›æ ¹æ®æŸä¸ªç‰¹å®šå±æ€§è¿›è¡Œè®¡ç®—ï¼Œå¯ä»¥ä½¿ç”¨ `-Property` å‚æ•°ã€‚ä¾‹å¦‚ï¼Œè®¡ç®—æ‰€æœ‰è¿›ç¨‹çš„ `WorkingSet` å†…å­˜å¤§å°ï¼š

```powershell
Get-Process | Measure-Object -Property WorkingSet -Sum -Average -Maximum -Minimum
```

è¾“å‡ºç»“æœå°†åŒ…å«è¿›ç¨‹ä½¿ç”¨çš„å†…å­˜çš„æ€»å’Œã€å¹³å‡å€¼ã€æœ€å¤§å€¼å’Œæœ€å°å€¼ã€‚

##### 4. è®¡ç®—æ–‡ä»¶çš„è¡Œæ•°ã€å•è¯æ•°å’Œå­—ç¬¦æ•°

å¦‚æœå¤„ç†æ–‡æœ¬æ–‡ä»¶ï¼Œå¯ä»¥ç”¨ `Measure-Object` æ¥è®¡ç®—æ–‡ä»¶çš„è¡Œæ•°ã€å•è¯æ•°å’Œå­—ç¬¦æ•°ï¼š

```powershell
Get-Content "C:\path\to\your\file.txt" | Measure-Object -Line -Word -Character
```

è¾“å‡ºï¼š

```plaintext
Lines      : 100
Words      : 500
Characters : 2000
```

##### 5. ä»…è®¡ç®—æŸä¸€åˆ—çš„ç»Ÿè®¡ä¿¡æ¯

åœ¨ä¸€ä¸ªåŒ…å«å¯¹è±¡çš„æ•°ç»„ä¸­ï¼Œä½ å¯ä»¥é€‰æ‹©æŸä¸ªç‰¹å®šåˆ—è¿›è¡Œç»Ÿè®¡ã€‚ä¾‹å¦‚ï¼Œè®¡ç®— CSV æ–‡ä»¶ä¸­çš„æŸä¸€åˆ—çš„ç»Ÿè®¡æ•°æ®ï¼š

```powershell
Import-Csv "C:\path\to\your\data.csv" | Measure-Object -Property Age -Sum -Average -Minimum -Maximum
```

å‡è®¾ `data.csv` æ–‡ä»¶åŒ…å«ä¸€åˆ— `Age`ï¼Œç»“æœå°†æ˜¾ç¤ºè¯¥åˆ—çš„æ€»å’Œã€å¹³å‡å€¼ç­‰ã€‚

##### 6. è®¡ç®—å­—ç¬¦ä¸²çš„é•¿åº¦

å¯ä»¥ä½¿ç”¨ `Measure-Object` è®¡ç®—å­—ç¬¦ä¸²çš„é•¿åº¦ï¼š

```powershell
"Hello PowerShell" | Measure-Object -Character
```

è¾“å‡ºï¼š

```plaintext
Count       : 1
Characters  : 15
```

##### 7. å¤„ç†æ•°æ®æ—¶çš„è¿‡æ»¤æ“ä½œ

ä½ å¯ä»¥å°† `Measure-Object` å’Œå…¶ä»–è¿‡æ»¤å‘½ä»¤ä¸€èµ·ä½¿ç”¨ï¼Œæ¯”å¦‚ `Where-Object`ã€‚ä¾‹å¦‚ï¼Œè®¡ç®—è¿è¡Œæ—¶é—´å¤§äº 1000ms çš„è¿›ç¨‹æ•°é‡ï¼š

```powershell
Get-Process | Where-Object { $_.CPU -gt 1000 } | Measure-Object
```

è¾“å‡ºä¼šæ˜¾ç¤ºç¬¦åˆæ¡ä»¶çš„è¿›ç¨‹æ•°é‡ã€‚

##### 8. è®¡ç®—æ–‡ä»¶å¤¹ä¸­æ–‡ä»¶çš„å¤§å°

ä½ å¯ä»¥ä½¿ç”¨ `Measure-Object` æ¥è®¡ç®—æ–‡ä»¶å¤¹ä¸­æ‰€æœ‰æ–‡ä»¶çš„æ€»å¤§å°ï¼š

```powershell
Get-ChildItem "C:\path\to\folder" -File | Measure-Object -Property Length -Sum
```

è¾“å‡ºå°†æ˜¾ç¤ºè¯¥æ–‡ä»¶å¤¹ä¸­æ‰€æœ‰æ–‡ä»¶çš„æ€»å¤§å°ã€‚

##### 9. å¯¹æ—¶é—´è¿›è¡Œç»Ÿè®¡åˆ†æ

å¦‚æœä½ æœ‰ä¸€ä¸ªæ—¶é—´æ•°æ®ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ `Measure-Object` å¯¹å…¶è¿›è¡Œåˆ†æã€‚æ¯”å¦‚ï¼Œè®¡ç®—è¿›ç¨‹çš„ CPU æ—¶é—´çš„æ€»å’Œã€å¹³å‡å€¼ç­‰ï¼š

```powershell
Get-Process | Measure-Object -Property CPU -Sum -Average -Maximum -Minimum
```

##### 10. ç»“åˆç®¡é“ç¬¦çš„é«˜çº§ä½¿ç”¨

é€šè¿‡ç®¡é“æ“ä½œï¼Œå°†å¤šä¸ªå‘½ä»¤ç»„åˆä½¿ç”¨ï¼Œè¾¾åˆ°æ›´åŠ å¤æ‚çš„æ•°æ®ç»Ÿè®¡éœ€æ±‚ã€‚æ¯”å¦‚ï¼Œç»Ÿè®¡æŸä¸€ç±»å‹çš„æ–‡ä»¶æ•°é‡åŠå…¶æ€»å¤§å°ï¼š

```powershell
Get-ChildItem "C:\path\to\folder" -Recurse -File | Where-Object { $_.Extension -eq ".txt" } | Measure-Object -Property Length -Sum
```

è¿™æ®µä»£ç é€’å½’åœ°è·å–æ–‡ä»¶å¤¹ä¸­çš„ `.txt` æ–‡ä»¶ï¼Œå¹¶è®¡ç®—å®ƒä»¬çš„æ€»å¤§å°ã€‚

---

#### 5. Group-Object å¯¹è±¡åˆ†ç»„
`Group-Object` ç”¨äºæ ¹æ®å¯¹è±¡çš„æŸä¸ªå±æ€§å¯¹å¯¹è±¡è¿›è¡Œåˆ†ç»„ã€‚

**è¯­æ³•**:
```powershell
Group-Object [-Property] <string>
```

**ç¤ºä¾‹**:
```powershell
Get-Service | Group-Object Status
```
è¿™ä¸ªå‘½ä»¤å°†æœåŠ¡æ ¹æ®å…¶çŠ¶æ€ï¼ˆ`Running` æˆ– `Stopped`ï¼‰è¿›è¡Œåˆ†ç»„ã€‚

#### 6. Compare-Object æ•°æ®æ¯”è¾ƒ
`Compare-Object` ç”¨äºæ¯”è¾ƒä¸¤ä¸ªæ•°æ®é›†ã€‚

**è¯­æ³•**:
```powershell
Compare-Object [-ReferenceObject] <Object[]> [-DifferenceObject] <Object[]>
```

**ç¤ºä¾‹**:
```powershell
$a = Get-Process | Select-Object Name
$b = Get-Service | Select-Object Name
Compare-Object $a $b
```
è¯¥å‘½ä»¤æ¯”è¾ƒè¿›ç¨‹å’ŒæœåŠ¡çš„åç§°ï¼Œæ‰¾å‡ºä¸ç›¸åŒçš„éƒ¨åˆ†ã€‚

#### 7. Out-File æ•°æ®å†™å…¥
`Out-File` å°†æ•°æ®å†™å…¥æ–‡ä»¶ã€‚

**è¯­æ³•**:
```powershell
Out-File [-FilePath] <string>
```

**ç¤ºä¾‹**:
```powershell
Get-Process | Out-File "C:\process.txt"
```
è¿™å°†è¿›ç¨‹åˆ—è¡¨è¾“å‡ºåˆ° `C:\process.txt` æ–‡ä»¶ä¸­ã€‚

### 1.2 æ ¼å¼åŒ–ä¸è¾“å‡º

- `ConvertTo-Json`: å°†å¯¹è±¡è½¬æ¢ä¸º JSON æ ¼å¼
- `ConvertFrom-Json`: ä» JSON æ ¼å¼è½¬æ¢ä¸ºå¯¹è±¡
- `Export-Csv`: å¯¼å‡ºä¸º CSV æ–‡ä»¶
- `Import-Csv`: ä» CSV æ–‡ä»¶å¯¼å…¥æ•°æ®
- `ConvertTo-Xml`: å°†å¯¹è±¡è½¬æ¢ä¸º XML æ ¼å¼

### 1.3 ç»Ÿè®¡ä¸è®¡ç®—

### 1.4 æ•°æ®è½¬æ¢å’Œå¯¼å‡º

## 3. æ–‡ä»¶å’Œç›®å½•æ“ä½œ

### 3.1 ç›®å½•ç®¡ç†
#### **Get-Locationï¼ˆ`pwd`ï¼‰**

-   ç”¨é€”ï¼šè·å–å½“å‰ç›®å½•ã€‚
-   ç¤ºä¾‹ï¼š`Get-Location`

#### **Set-Locationï¼ˆ`cd`ï¼‰**

-   ç”¨é€”ï¼šæ›´æ”¹å½“å‰ç›®å½•ã€‚
-   ç¤ºä¾‹ï¼š`Set-Location C:\Users`

#### **Get-ChildItemï¼ˆ`ls`ã€`dir`ï¼‰**

-   ç”¨é€”ï¼šè·å–å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶å’Œå­ç›®å½•åˆ—è¡¨ã€‚

- å‚æ•°è¯´æ˜
    - pathï¼šæŒ‡å®šè·¯å¾„
    - psiscontainerï¼šåˆ¤æ–­æ˜¯æ–‡ä»¶å¤¹ï¼ˆtrueï¼‰è¿˜æ˜¯æ–‡ä»¶ï¼ˆfalseï¼‰

### 3.2 æ–‡ä»¶ç®¡ç†

#### **New-Item**

-   ç”¨é€”ï¼šåˆ›å»ºæ–°æ–‡ä»¶æˆ–ç›®å½•ã€‚
-   ç¤ºä¾‹ï¼š`New-Item -Path . -Name "test.txt" -ItemType "file"`

#### **Remove-Itemï¼ˆ`rm`ã€`del`ï¼‰**

-   ç”¨é€”ï¼šåˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ã€‚
-   ç¤ºä¾‹ï¼š`Remove-Item -Path "test.txt"`

#### **Copy-Itemï¼ˆ`cp`ï¼‰**

-   ç”¨é€”ï¼šå¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•ã€‚
-   ç¤ºä¾‹ï¼š`Copy-Item -Path "test.txt" -Destination "copy_test.txt"`

#### **Move-Itemï¼ˆ`mv`ï¼‰**

-   ç”¨é€”ï¼šç§»åŠ¨æ–‡ä»¶æˆ–ç›®å½•ã€‚
-   ç¤ºä¾‹ï¼š`Move-Item -Path "test.txt" -Destination "new_test.txt"`

### 3.3 æ–‡ä»¶å†…å®¹ç®¡ç†

11. **`Get-Content`ï¼ˆ`cat`ã€`type`ï¼‰**

    -   ç”¨é€”ï¼šè·å–æ–‡ä»¶å†…å®¹ã€‚
    -   ç¤ºä¾‹ï¼š`Get-Content -Path "test.txt"`

12. **`Set-Content`**

    -   ç”¨é€”ï¼šå†™å…¥æ–‡ä»¶å†…å®¹ï¼ˆè¦†ç›–ï¼‰ã€‚
    -   ç¤ºä¾‹ï¼š`Set-Content -Path "test.txt" -Value "New content"`

13. **`Add-Content`**
    -   ç”¨é€”ï¼šè¿½åŠ æ–‡ä»¶å†…å®¹ã€‚
    -   ç¤ºä¾‹ï¼š`Add-Content -Path "test.txt" -Value "Additional content"`

### 3.4 æƒé™å’Œå±æ€§ç®¡ç†

## 4. ç³»ç»Ÿç®¡ç†ç±»

### 4.1 å˜é‡ç®¡ç†
1. **`Set-Variable`**ï¼šåˆ›å»ºæ–°çš„å˜é‡æˆ–è€…ä¿®æ”¹ç°æœ‰å˜é‡çš„å€¼ã€‚
   - ä¾‹å­ï¼š
     ```powershell
     Set-Variable -Name "myVar" -Value 123
     ```

2. **`Get-Variable`**ï¼šè·å–å½“å‰ä¼šè¯ä¸­çš„å˜é‡åŠå…¶å€¼ã€‚
   - ä¾‹å­ï¼š
     ```powershell
     Get-Variable -Name "myVar"
     ```

3. **`Remove-Variable`**ï¼šåˆ é™¤ä¸€ä¸ªå˜é‡ã€‚
   - ä¾‹å­ï¼š
     ```powershell
     Remove-Variable -Name "myVar"
     ```

4. **`Clear-Variable`**ï¼šæ¸…ç©ºå˜é‡çš„å€¼ï¼Œè€Œä¸åˆ é™¤å˜é‡ã€‚
   - ä¾‹å­ï¼š
     ```powershell
     Clear-Variable -Name "myVar"
     ```

5. **`New-Variable`**ï¼šæ–°å»ºä¸€ä¸ªå˜é‡ï¼Œå¹¶å¯è®¾ç½®å˜é‡çš„ç±»å‹ã€ä½œç”¨åŸŸå’Œæ˜¯å¦åªè¯»ã€‚
   - ä¾‹å­ï¼š
     ```powershell
     New-Variable -Name "myVar" -Value 456 -Option ReadOnly
     ```

### 4.2 è¿›ç¨‹ä¸æœåŠ¡ç®¡ç†

14. **`Get-Process`ï¼ˆ`ps`ï¼‰**

    -   ç”¨é€”ï¼šè·å–å½“å‰è¿è¡Œçš„è¿›ç¨‹åˆ—è¡¨ã€‚
    -   ç¤ºä¾‹ï¼š`Get-Process`

15. **`Stop-Process`ï¼ˆ`kill`ï¼‰**

    -   ç”¨é€”ï¼šåœæ­¢è¿›ç¨‹ã€‚
    -   ç¤ºä¾‹ï¼š`Stop-Process -Name "notepad"`

16. **`Get-Service`**

    -   ç”¨é€”ï¼šè·å–å½“å‰ç³»ç»ŸæœåŠ¡åˆ—è¡¨ã€‚
    -   ç¤ºä¾‹ï¼š`Get-Service`

17. **`Start-Service`**

    -   ç”¨é€”ï¼šå¯åŠ¨æœåŠ¡ã€‚
    -   ç¤ºä¾‹ï¼š`Start-Service -Name "wuauserv"`

18. **`Stop-Service`**
    -   ç”¨é€”ï¼šåœæ­¢æœåŠ¡ã€‚
    -   ç¤ºä¾‹ï¼š`Stop-Service -Name "wuauserv"`

### 4.3 ç½‘ç»œç®¡ç†

1. **`Test-Connection`ï¼ˆ`ping`ï¼‰**

    -   ç”¨é€”ï¼šæµ‹è¯•ç½‘ç»œè¿æ¥ã€‚å¯ä»¥ä»£æ›¿pingå’Œtelnetå‘½ä»¤ã€‚
    -   ç¤ºä¾‹ï¼š`Test-Connection -ComputerName "google.com"`

    Test-NetConnection -ComputerName IPåœ°å€ -Port 25565

    ComputerName     : xx.xx.xx.xx
    RemoteAddress    : xx.xx.xx.xx
    RemotePort       : 25565
    InterfaceAlias   : WLAN
    SourceAddress    : 192.168.2.102
    TcpTestSucceeded : True

2. **`Get-NetIPAddress`**

    -   ç”¨é€”ï¼šè·å–ç½‘ç»œæ¥å£çš„ IP åœ°å€ä¿¡æ¯ã€‚
    -   ç¤ºä¾‹ï¼š`Get-NetIPAddress`

3. **`Get-NetAdapter`**
    -   ç”¨é€”ï¼šè·å–ç½‘ç»œé€‚é…å™¨ä¿¡æ¯ã€‚
    -   ç¤ºä¾‹ï¼š`Get-NetAdapter`

### 4.4 ç³»ç»Ÿä¿¡æ¯ä¸ç¡¬ä»¶ç®¡ç†

#### 1. Clear-RecycleBin
- æ¸…ç©ºå›æ”¶ç«™

#### 2. Get-EventLog
-   ç”¨é€”ï¼šè·å–äº‹ä»¶æ—¥å¿—ã€‚
-   ç¤ºä¾‹ï¼š`Get-EventLog -LogName "System"`

#### 3. **Get-WmiObject**
-   ç”¨é€”ï¼šè·å– WMIï¼ˆWindows Management Instrumentationï¼‰å¯¹è±¡ä¿¡æ¯ã€‚
-   ç¤ºä¾‹ï¼š`Get-WmiObject -Class Win32_OperatingSystem`

#### 4. Get-CimInstance
- CMIï¼šCommon Information Model
- ç”¨é€”ï¼šæŸ¥è¯¢ç³»ç»Ÿç¡¬ä»¶ä¿¡æ¯ï¼Œå®ƒé€šè¿‡ WMIï¼ˆWindows Management Instrumentationï¼‰æ¥å£è®¿é—®åº•å±‚ç³»ç»Ÿçš„ç¡¬ä»¶çŠ¶æ€ã€‚é€šè¿‡æŒ‡å®šä¸åŒçš„ `-ClassName` å‚æ•°ï¼Œå¯ä»¥è·å–å…³äºè®¡ç®—æœºç¡¬ä»¶çš„å„ç±»è¯¦ç»†ä¿¡æ¯ã€‚

##### **1. å¸¸è§ç¡¬ä»¶ä¿¡æ¯æŸ¥è¯¢åŠå¯¹åº” `-ClassName`**

| ç¡¬ä»¶ç±»åˆ«          | æè¿°                           | å¸¸ç”¨ `-ClassName` å€¼                       |
|-------------------|--------------------------------|-------------------------------------------|
| **å¤„ç†å™¨ (CPU)**  | æŸ¥è¯¢å¤„ç†å™¨çš„å‹å·ã€æ ¸å¿ƒæ•°ã€æ—¶é’Ÿé¢‘ç‡ç­‰ | `Win32_Processor`                        |
| **å†…å­˜ (RAM)**    | æŸ¥è¯¢ç‰©ç†å†…å­˜æ¨¡å—çš„ä¿¡æ¯          | `Win32_PhysicalMemory`                   |
| **ç¡¬ç›˜**          | æŸ¥è¯¢é€»è¾‘æˆ–ç‰©ç†ç£ç›˜çš„ä¿¡æ¯        | `Win32_DiskDrive`, `Win32_LogicalDisk`   |
| **ä¸»æ¿**          | æŸ¥è¯¢ä¸»æ¿åˆ¶é€ å•†ã€å‹å·ç­‰ä¿¡æ¯      | `Win32_BaseBoard`                        |
| **BIOS**          | æŸ¥è¯¢ BIOS ç‰ˆæœ¬å’Œå‚å•†ä¿¡æ¯        | `Win32_BIOS`                             |
| **æ˜¾å¡ (GPU)**    | æŸ¥è¯¢æ˜¾å¡å‹å·åŠé©±åŠ¨ç¨‹åºä¿¡æ¯      | `Win32_VideoController`                  |
| **ç½‘å¡**          | æŸ¥è¯¢ç½‘ç»œé€‚é…å™¨ï¼ˆæœ‰çº¿/æ— çº¿ï¼‰ä¿¡æ¯  | `Win32_NetworkAdapter`                   |
| **ç”µæ± **          | æŸ¥è¯¢ç¬”è®°æœ¬ç”µæ± çŠ¶æ€              | `Win32_Battery`                          |
| **æ˜¾ç¤ºå™¨**        | æŸ¥è¯¢æ˜¾ç¤ºå™¨å‹å·ã€åˆ†è¾¨ç‡ç­‰ä¿¡æ¯     | `Win32_DesktopMonitor`                   |
| **è¾“å…¥è®¾å¤‡**      | æŸ¥è¯¢é”®ç›˜ã€é¼ æ ‡ç­‰è¾“å…¥è®¾å¤‡         | `Win32_Keyboard`, `Win32_PointingDevice` |
| **æ‰“å°æœº**        | æŸ¥è¯¢æ‰“å°æœºçŠ¶æ€å’Œè¿æ¥ä¿¡æ¯         | `Win32_Printer`                          |

##### **2. è¯¦ç»†ç¤ºä¾‹**

##### **(1) æŸ¥è¯¢å¤„ç†å™¨ä¿¡æ¯**
```powershell
Get-CimInstance -ClassName Win32_Processor | Select-Object Name, NumberOfCores, MaxClockSpeed
```
**è¾“å‡ºç¤ºä¾‹**ï¼š
```plaintext
Name                 NumberOfCores MaxClockSpeed
----                 ------------- -------------
Intel(R) Core(TM) i7-9700 CPU @ 3.00GHz  8          3000
```

##### **(2) æŸ¥è¯¢ç‰©ç†å†…å­˜æ¨¡å—ä¿¡æ¯**
```powershell
Get-CimInstance -ClassName Win32_PhysicalMemory | Select-Object Manufacturer, Capacity, Speed
```
**è¾“å‡ºç¤ºä¾‹**ï¼š
```plaintext
Manufacturer Capacity       Speed
------------ --------       -----
Samsung      8589934592     2400
Kingston     8589934592     2400
```

##### **(3) æŸ¥è¯¢ç£ç›˜ä¿¡æ¯**
- **ç‰©ç†ç£ç›˜ï¼š**
```powershell
Get-CimInstance -ClassName Win32_DiskDrive | Select-Object Model, Size, MediaType
```
**è¾“å‡ºç¤ºä¾‹**ï¼š
```plaintext
Model                           Size        MediaType
-----                           ----        ---------
Samsung SSD 860 EVO 1TB         1000204886016 Fixed hard disk
Seagate ST1000LM048             1000204886016 Fixed hard disk
```

- **é€»è¾‘ç£ç›˜ï¼ˆåˆ†åŒºï¼‰ï¼š**
```powershell
Get-CimInstance -ClassName Win32_LogicalDisk | Select-Object DeviceID, FreeSpace, Size, VolumeName
```
**è¾“å‡ºç¤ºä¾‹**ï¼š
```plaintext
DeviceID FreeSpace      Size           VolumeName
-------- ---------      ----           ----------
C:       530000000000   1000000000000  Windows
D:       200000000000   500000000000   Data
```

##### **(4) æŸ¥è¯¢æ˜¾å¡ä¿¡æ¯**
```powershell
Get-CimInstance -ClassName Win32_VideoController | Select-Object Name, AdapterRAM, DriverVersion
```
**è¾“å‡ºç¤ºä¾‹**ï¼š
```plaintext
Name                                  AdapterRAM    DriverVersion
----                                  ----------    -------------
NVIDIA GeForce GTX 1660 Ti            4294967296    30.0.14.7212
Intel(R) UHD Graphics 630             1073741824    27.20.100.9365
```

##### **(5) æŸ¥è¯¢ç½‘å¡ä¿¡æ¯**
```powershell
Get-CimInstance -ClassName Win32_NetworkAdapter | Select-Object Name, NetEnabled, MACAddress
```
**è¾“å‡ºç¤ºä¾‹**ï¼š
```plaintext
Name                          NetEnabled MACAddress
----                          ---------- ----------
Intel(R) Ethernet Connection         True  00-1A-2B-3C-4D-5E
Realtek PCIe GBE Family Controller    False 11-22-33-44-55-66
```

##### **(6) æŸ¥è¯¢ç”µæ± çŠ¶æ€**
```powershell
Get-CimInstance -ClassName Win32_Battery | Select-Object EstimatedChargeRemaining, BatteryStatus
```
**è¾“å‡ºç¤ºä¾‹**ï¼š
```plaintext
EstimatedChargeRemaining BatteryStatus
------------------------- -------------
85                       2
```

##### **(7) æŸ¥è¯¢ BIOS ä¿¡æ¯**
```powershell
Get-CimInstance -ClassName Win32_BIOS | Select-Object Manufacturer, SMBIOSBIOSVersion, ReleaseDate
```
**è¾“å‡ºç¤ºä¾‹**ï¼š
```plaintext
Manufacturer  SMBIOSBIOSVersion ReleaseDate
------------  ----------------- -----------
Dell Inc.     1.14.0            20231001000000.000000+000
```

---

##### **3. å¸¸ç”¨çš„å…¶ä»–ç¡¬ä»¶ç±»**
é™¤äº†ä¸Šè¿°ç±»ï¼Œè¿˜æœ‰ä¸€äº›å¸¸ç”¨çš„ `-ClassName` å€¼å¯ä»¥æŸ¥è¯¢æ›´è¯¦ç»†çš„ä¿¡æ¯ï¼š

| ç±»å                           | æè¿°                                   |
|--------------------------------|----------------------------------------|
| `Win32_CDROMDrive`             | CD/DVD é©±åŠ¨å™¨ä¿¡æ¯                      |
| `Win32_USBHub`                 | USB è®¾å¤‡ä¿¡æ¯                          |
| `Win32_ComputerSystem`         | è®¡ç®—æœºç³»ç»Ÿä¿¡æ¯ï¼ˆåˆ¶é€ å•†ã€å‹å·ç­‰ï¼‰       |
| `Win32_SystemEnclosure`        | æœºç®±ç›¸å…³ä¿¡æ¯                          |
| `Win32_PnPEntity`              | å³æ’å³ç”¨è®¾å¤‡                          |
| `Win32_SoundDevice`            | å£°å¡ä¿¡æ¯                              |
| `Win32_StorageVolume`          | å­˜å‚¨å·ä¿¡æ¯                            |
| `Win32_Processor`              | å¤„ç†å™¨è¯¦ç»†ä¿¡æ¯                        |
| `Win32_PrinterConfiguration`   | æ‰“å°æœºé…ç½®                            |

---

##### **4. å¦‚ä½•åˆ—å‡ºæ‰€æœ‰å¯ç”¨ç±»**
åœ¨ PowerShell ä¸­å¯ä»¥åˆ—å‡ºæ‰€æœ‰çš„ WMI ç±»ä»¥ä¾›å‚è€ƒï¼š
```powershell
Get-CimClass | Select-Object CimClassName, CimNamespace
```

**ç»“æœç¤ºä¾‹ï¼š**
```plaintext
CimClassName             CimNamespace
------------             ------------
Win32_OperatingSystem    root\cimv2
Win32_Processor          root\cimv2
Win32_PhysicalMemory     root\cimv2
...
```

```powershell
åœ¨PowerShellä¸­æŸ¥çœ‹æœ¬æœºçš„CPUã€ä¸»æ¿ã€å†…å­˜ã€æ˜¾å¡ã€æ˜¾ç¤ºå™¨ã€å£°å¡ã€ç½‘å¡ç­‰ç¡¬ä»¶è®¾å¤‡çš„å‹å·ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š


# 1. CPUå‹å·
Get-CimInstance -ClassName Win32_Processor | Select-Object Name
è¿™æ¡å‘½ä»¤ä¼šè¿”å›CPUçš„åç§°ï¼Œé€šå¸¸åŒ…å«äº†å‹å·ä¿¡æ¯ã€‚

# 2. ä¸»æ¿ä¿¡æ¯
Get-CimInstance -ClassName Win32_BaseBoard | Select-Object Manufacturer, Product, Version, SerialNumber
è¿™æ¡å‘½ä»¤å¯ä»¥è·å–ä¸»æ¿çš„åˆ¶é€ å•†ã€äº§å“åç§°ã€ç‰ˆæœ¬å’Œåºåˆ—å·ã€‚

# 3. å†…å­˜ä¿¡æ¯
Get-CimInstance -ClassName Win32_PhysicalMemory | Select-Object Capacity, Speed
è¿™æ¡å‘½ä»¤ä¼šè¿”å›è®¡ç®—æœºçš„å†…å­˜æ¡å®¹é‡å’Œé€Ÿåº¦ä¿¡æ¯ã€‚

### 4. æ˜¾å¡å‹å·
Get-CimInstance -ClassName Win32_VideoController | Select-Object Name
è¿™æ¡å‘½ä»¤ä¼šè¿”å›æ˜¾å¡çš„åç§°ï¼Œé€šå¸¸åŒ…å«äº†å‹å·ä¿¡æ¯ã€‚

### 5. æ˜¾ç¤ºå™¨å‹å·
Get-CimInstance -ClassName Win32_DesktopMonitor | Select-Object Name
è¿™æ¡å‘½ä»¤å¯ä»¥è·å–æ˜¾ç¤ºå™¨çš„åç§°ï¼Œé€šå¸¸åŒ…å«äº†å‹å·ä¿¡æ¯ã€‚

### 6. å£°å¡å‹å·
Get-CimInstance -ClassName Win32_SoundDevice | Select-Object Name
è¿™æ¡å‘½ä»¤ä¼šè¿”å›å£°å¡çš„åç§°ï¼Œé€šå¸¸åŒ…å«äº†å‹å·ä¿¡æ¯ã€‚

### 7. ç½‘å¡å‹å·
Get-CimInstance -ClassName Win32_NetworkAdapterConfiguration | Select-Object Description
è¿™æ¡å‘½ä»¤ä¼šè¿”å›ç½‘å¡çš„æè¿°ï¼Œé€šå¸¸åŒ…å«äº†å‹å·ä¿¡æ¯ã€‚
```

#### get-computerinfo

è·å–è®¡ç®—æœºåŸºæœ¬ä¿¡æ¯ã€‚

## 4. è„šæœ¬å’Œè‡ªåŠ¨åŒ–

### 1. Invoke-Expressionï¼ˆç¼©å†™ä¸ºiexï¼‰
ç”¨äºæ‰§è¡Œè¡¨è¾¾å¼ï¼Œå°†å­—ç¬¦ä¸²å†…å®¹ä½œä¸º PowerShell å‘½ä»¤æˆ–è„šæœ¬ç›´æ¥è¿è¡Œã€‚

- åœ¨æ‰§è¡Œä»å¤–éƒ¨æ¥æºåŠ è½½çš„è„šæœ¬ã€åœ¨è„šæœ¬ä¸­ä½¿ç”¨å˜é‡åŠ¨æ€ç”Ÿæˆä»£ç å—æ—¶éå¸¸æœ‰ç”¨ã€‚
- éœ€è¦å°å¿ƒä½¿ç”¨ä»¥é¿å…æ‰§è¡Œæ¶æ„æˆ–æœªéªŒè¯çš„ä»£ç ã€‚

### `iex` çš„åŸºæœ¬ç”¨æ³•

1. **åŸºæœ¬è¯­æ³•**
   ```powershell
   Invoke-Expression -Command "<expression>"
   # æˆ–ä½¿ç”¨ç®€å†™å½¢å¼ï¼š
   iex "<expression>"
   ```
   `<expression>`éƒ¨åˆ†å¯ä»¥æ˜¯ä¸€ä¸ª PowerShell å‘½ä»¤æˆ–åŒ…å«ä»£ç çš„å­—ç¬¦ä¸²ã€‚

2. **æ‰§è¡Œå˜é‡å†…å®¹**
   å¯ä»¥å°†ä¸€ä¸ªåŒ…å«å‘½ä»¤çš„å­—ç¬¦ä¸²ç›´æ¥ä½œä¸ºè¡¨è¾¾å¼æ‰§è¡Œã€‚ä¾‹å¦‚ï¼š
   ```powershell
   $cmd = "Get-Date"
   iex $cmd
   ```
   è¿™å°†è¿è¡Œ`Get-Date`å‘½ä»¤å¹¶è¾“å‡ºå½“å‰æ—¥æœŸå’Œæ—¶é—´ã€‚

3. **ä»å¤–éƒ¨èµ„æºåŠ¨æ€æ‰§è¡Œä»£ç **
   `iex`é€šå¸¸ç”¨äºåŠ¨æ€åŠ è½½ä»£ç ï¼Œä¾‹å¦‚ä»URLä¸‹è½½è„šæœ¬ç„¶åç›´æ¥æ‰§è¡Œï¼š
   ```powershell
   $scriptURL = "https://example.com/script.ps1"
   $scriptContent = Invoke-RestMethod -Uri $scriptURL
   iex $scriptContent
   ```
   è¿™ç§ç”¨æ³•åœ¨åŠ è½½æœªç»éªŒè¯çš„è„šæœ¬æ—¶è¦ç‰¹åˆ«å°å¿ƒï¼Œå› ä¸ºå®ƒä¼šç›´æ¥æ‰§è¡Œä¸‹è½½å†…å®¹ã€‚

### å…¸å‹åº”ç”¨åœºæ™¯

- **åŠ¨æ€è„šæœ¬ç”Ÿæˆ**ï¼šç”¨äºç”ŸæˆåŒ…å«å˜é‡çš„å¤æ‚å‘½ä»¤ï¼Œä¾‹å¦‚ï¼Œåˆ›å»ºå’Œæ‰§è¡Œå¤šç§é…ç½®ç»„åˆçš„è„šæœ¬ã€‚
- **è‡ªå®šä¹‰å‘½ä»¤æ‰§è¡Œ**ï¼šåœ¨ç”¨æˆ·è¾“å…¥åŠ¨æ€å‘½ä»¤çš„åœºæ™¯ä¸­ï¼Œé€šè¿‡å­—ç¬¦ä¸²å¤„ç†å°†ç”¨æˆ·çš„è¾“å…¥ä½œä¸ºä»£ç æ‰§è¡Œã€‚
- **ç®€åŒ–ä»£ç å¤„ç†**ï¼šåœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œç”¨`iex`æ‰§è¡Œå­—ç¬¦ä¸²å½¢å¼çš„ä»£ç å¯ä»¥ç®€åŒ–è„šæœ¬ä¸­çš„æ¡ä»¶å’Œé…ç½®é€»è¾‘ã€‚

### ä½¿ç”¨`iex`çš„æ³¨æ„äº‹é¡¹

`Invoke-Expression`å¯¹å®‰å…¨æ€§è¦æ±‚è¾ƒé«˜ï¼Œå› ä¸ºå®ƒä¼šæ‰§è¡Œä¼ å…¥çš„æ‰€æœ‰ä»£ç ï¼Œæ‰€ä»¥éœ€è¦è°¨æ…ä½¿ç”¨ï¼š

- **é¿å…ç›´æ¥æ‰§è¡Œæœªç»éªŒè¯çš„è¾“å…¥**ï¼šé¿å…ç›´æ¥è¿è¡Œç”¨æˆ·è¾“å…¥æˆ–ä»ä¸å¯ä¿¡æ¥æºè·å–çš„å†…å®¹ã€‚
- **ä½¿ç”¨`-Command`å‚æ•°**ï¼šç¡®ä¿ä¼ å…¥çš„å†…å®¹å·²ç»è¿‡æ£€éªŒï¼Œå¯ä»¥æ§åˆ¶ä»£ç çš„é¢„æœŸæ‰§è¡Œã€‚
  
### ç¤ºä¾‹ä»£ç 

```powershell
# åŠ¨æ€æ‰§è¡Œå˜é‡å†…å®¹
$command = "Write-Output 'Hello, World!'"
iex $command

# æ‰§è¡Œç”¨æˆ·é€‰æ‹©çš„å‘½ä»¤
$userChoice = Read-Host -Prompt "è¯·è¾“å…¥ä¸€ä¸ªå‘½ä»¤ï¼ˆä¾‹å¦‚ï¼ŒGet-Processï¼‰"
iex $userChoice
```

`iex` çš„å¼ºå¤§åŠŸèƒ½ä½¿å…¶åœ¨åŠ¨æ€è„šæœ¬ç”Ÿæˆå’Œè‡ªåŠ¨åŒ–ä»»åŠ¡ä¸­éå¸¸æœ‰ç”¨ï¼Œä½†ç”±äºå…¶å¯ä»¥ç›´æ¥æ‰§è¡Œå­—ç¬¦ä¸²å†…å®¹ï¼Œå¿…é¡»å°å¿ƒé˜²èŒƒæ½œåœ¨çš„å®‰å…¨é£é™©ã€‚
### 24. **`Invoke-Command`**

    -   ç”¨é€”ï¼šåœ¨æœ¬åœ°æˆ–è¿œç¨‹è®¡ç®—æœºä¸Šè¿è¡Œå‘½ä»¤ã€‚
    -   ç¤ºä¾‹ï¼š`Invoke-Command -ScriptBlock { Get-Process }`

25. **`Start-Job`**

    -   ç”¨é€”ï¼šå¯åŠ¨åå°ä½œä¸šã€‚
    -   ç¤ºä¾‹ï¼š`Start-Job -ScriptBlock { Get-Process }`

26. **`Get-Job`**

    -   ç”¨é€”ï¼šè·å–åå°ä½œä¸šçŠ¶æ€ã€‚
    -   ç¤ºä¾‹ï¼š`Get-Job`

27. **`Receive-Job`**
    -   ç”¨é€”ï¼šè·å–åå°ä½œä¸šç»“æœã€‚
    -   ç¤ºä¾‹ï¼š`Receive-Job -Id 1`

## 5. åŒ…ç®¡ç†

28. **`Find-Module`**

    -   ç”¨é€”ï¼šæŸ¥æ‰¾ PowerShell æ¨¡å—ã€‚
    -   ç¤ºä¾‹ï¼š`Find-Module -Name "PSReadline"`

29. **`Install-Module`**

    -   ç”¨é€”ï¼šå®‰è£… PowerShell æ¨¡å—ã€‚
    -   ç¤ºä¾‹ï¼š`Install-Module -Name "PSReadline"`

30. **`Update-Module`**
    -   ç”¨é€”ï¼šæ›´æ–° PowerShell æ¨¡å—ã€‚
    -   ç¤ºä¾‹ï¼š`Update-Module -Name "PSReadline"`
