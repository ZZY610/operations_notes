# 数据库

## 1. 数据管理技术的发展过程

### 1.1 数据、数据处理和数据管理

-   数据（data）是描述客观事物的符号。
-   数据处理：计算机数据处理是对数据进行收集、存储、加工、传播等一系列活动的总和，其目的是从大量从复杂的甚至难以理解的数据中抽取有价值、有意义的数据，作为决策的依据。
-   数据管理：数据管理是指对数据进行收集、整理、组织、存储、检索和维护等操作，其目的在于科学有效的保存和管理大量复杂的数据，充分有效地发挥数据的作用。
    -   数据管理是数据处理的核心

### 1.2 人工管理阶段

-   数据不能长期保存在计算机中。
-   应用程序管理数据，数据与程序结合在一起；若数据的逻辑结构或物理结构发生变化，则必须对程序进行修改；这种特性称为数据与程序不具有<span style="color:rgb(255,76,65)">独立性</span>。
-   数据是面向应用的，一组数据对应一个程序，数据不共享。当多个应用程序涉及相同数据时，必须各自定义。

### 1.3 文件系统阶段

-   优点：
    （1）数据能够长期保存，可以反复对其进行查询、修改等操作。
    （2）由专门软件对数据进行管理，应用程序与数据之间由文件系统所提供的存取方法进行转换，程序与数据之间有了一定的独立性。
-   缺点：
    （1）数据**共享性差**，冗余度大。
    （2）数据**独立性差**。同样的数据存储方式可能不一样，导致数据与程序**耦合**。
    （3）直接访问数据

### 1.4 数据库系统阶段

![Img](./FILES/01.%20数据库基本概念.md/img-20230307110341.png)

特点：
（1）数据结构化
（2）数据共享性高、冗余度低、易于扩充
（3）数据独立性高
（4）数据统一管理与控制
（5）间接访问数据

## 2. 数据库系统 （Database system）

-   数据库（Database，简称 DB）
    -   数据库是长期存储在计算机内有结构的大量的共享的数据集合。
-   数据库管理系统（DBMS）

    -   数据库管理系统是位于用户与操作系统之间的一层数据管理软件。
    -   数据库在建立、运用和维护时由数据库管理系统统一管理、统一控制。
    -   数据库系统（DBS）
        -   数据库系统是指在计算机系统中引入数据库后的系统构成，一般由数据库、数据库管理系统（及其开发工具）、应用系统、数据库管理员和用户构成。

-   数据冗余度：
    -   指同一数据重复存储时的重复程度。
-   数据的安全性（Security）
    -   数据的安全性是指保护数据，防止不合法使用数据造成数据的泄密和破坏，使每个用户只能按规定，对某些数据以某些方式进行访问和处理。
-   数据的完整性（Integrity）
    -   数据的完整性指数据的正确性、有效性和相容性。即将数据控制在有效的范围内，或要求数据之间满足一定的关系。
-   并发（Concurrency）控制
    -   当多个用户的并发进程同时存取、修改数据库时，可能会发生相互干扰而得到错误的结果并使得数据库的完整性遭到破坏，因此必须对多用户的并发操作加以控制和协调。
-   数据库恢复（Recovery）
    -   计算机系统的硬件故障、软件故障、操作员的失误以及故意的破坏也会影响数据库中数据的正确性，甚至造成数据库部分或全部数据的丢失。DBMS 必须具有将数据库从错误状态恢复到某一已知的正确状态（亦称为完整状态或一致状态）的功能。

### 数据库三要素

-   **数据**（描述事物的符号记录，数据库里面存储的内容）
-   **存储器**（外存，一般是硬盘，数据库的载体）
-   **数据库管理系统**（DBMS，数据库的管理软件，例如mysql、Oracle）

![Img](./FILES/01.%20数据库基本概念.md/img-20230307110354.png)

-   用户对数据库中数据的访问路径为：用户操作命令 → 应用程序 → DBMS → 数据库

## 3. 数据库体系结构

### 3.1 数据库系统的三级模式结构

![Img](./FILES/01.%20数据库基本概念.md/img-20230307132943.png)
数据库系统的三级模式结构是指数据库系统是由外模式、模式和内模式三级构成。

#### 模式

-   模式也称逻辑模式或概念模式，它是数据库中全体数据的逻辑结构和特征的描述。
-   一个数据库只有一个模式，它既不涉及物理存储细节、也不涉及应用程序和程序设计语言。
-   定义模式时，不仅要定义数据的逻辑结构，而且要定义数据之间的联系，以及与数据有关的安全性、完整性要求。

#### 外模式

-   外模式也称子模式或用户模式，它是模式的子集。
-   外模式是具体面向应用的，是数据库用户（包括应用程序员和最终用户）所能使用的局部数据的逻辑结构和特征的描述。
-   由于不同的应用有不同的外模式，因此一个数据库可以有多个外模式。

#### 内模式

-   内模式也称存储模式，它是数据库的物理结构，是数据库在存储介质上的存储结构。
-   内模式主要描述数据的物理结构和存储方式，例如，记录是按 B 树结构还是按 Hash 方式存储，索引如何组织、数据是否加密等。
-   一个数据库只有一个内模式。

### 3.2 数据库系统的二级映像

数据库系统的二级映像（mapping）是指外模式与模式之间、模式与内模式之间的映像关系 。

#### 外模式/模式映像

-   对于每一个外模式，数据库系统都有一个外模式/模式映像，它定义了该外模式与模式的对应关系。
-   外模式/模式映像保证了数据的逻辑独立性。
-   当模式发生改变时（如增加新的数据类型或数据项），只要对各外模式/模式映像作相应修改，就可以使外模式保持不变，从而不必修改应用程序。

#### 模式/内模式映像

-   数据库系统的模式/内模式映像是唯一的，它定义了数据库全局逻辑结构与存储结构之间的对应关系，其描述通常包含在模式定义中。
-   模式/内模式映像保证了数据库的物理独立性。
-   当数据库的存储结构发生改变时，对模式/内模式映像作相应的修改，就可以使模式保持不变，从而应用程序也不必修改。

### 3.3 数据库管理系统

![Img](./FILES/01.%20数据库基本概念.md/img-20230307141130.png)
数据库管理系统数据库管理系统（DBMS）是对数据进行统一管理与控制的专门系统软件。

#### 数据库管理系统的功能

① 有效地组织、存取和维护数据。
② 数据定义功能。DBMS 通过数据定义语言（Data Definition Language，DDL）定义数据库的各类数据对象，包括数据的结构、数据约束条件等。
③ 数据操纵功能。DBMS 提供数据操纵语言（Data Manipulation Language，DML），用户使用 DML 实现对数据库中的数据进行查询、增加、删除和修改等操作。
④ 数据库的事务管理和运行管理。DBMS 提供数据控制语言（Data Control Language，DCL），数据库管理员使用 DCL 实现对数据库的安全性保护、完整性检查、并发控制、数据库恢复等数据库控制功能。
⑤ 数据库的建立和维护功能。
⑥ 其他功能。包括：数据库初始数据输入与转换、数据库转储、数据库重组、数据库性能监视与分析、数据通信等，这些功能通常由 DBMS 提供的实用程序或管理工具完成。

## 4. 数据模型

### 4.1 数据模型的概念

-   模型
    -   是现实世界特征的模拟和抽象
-   数据模型
    -   也是一种模型，它是现实世界数据特征的抽象，表示实体以及实体间的联系
    -   ==一个用于描述数据、数据间关系、数据语义和数据约束的概念工具的集合==

### 4.2 基本数据模型

-   层次模型 (Hierarchical Model)
    -   最早使用的一种模型
    -   数据结构是一棵有向树
    -   特点
        -   (1) 有且仅有一个结点无双亲，该结点称为根结点。
        -   (2) 其他结点有且只有一个双亲
-   网状模型 (Network Model)
    -   数据结构是一个有向图
    -   特点
        -   （1）有一个以上的结点没有双亲
        -   （2）结点可以有多于一个的双亲
    -   能表示实体之间的多种复杂联系
-   **关系模型** (Relational Model)
    -   关系模型是用二维表格结构来表示实体及实体之间的联系的模型
    -   数据结构是一个“二维表框架”组成的集合
    -   关系模型概念简单,清晰,用户易懂易用,有严格的数学基础
    -   大多数数据库系统都是关系型的
    -   主要术语
        -   关系：一个关系对应于我们平常讲的一张表
        -   元组：表中的一行称为一个元组
        -   属性：表中的一列称为属性，每列的名称为属性名
        -   主码：表中的某个属性组，它们的值唯一的标识一个元组
        -   域：属性的取值范围
        -   分量：元组中的一个属性值
        -   关系模式：对关系的描述，用关系名（属性名 1，属性名 2，…，属性名 n）来表示
    -   特点
        1. 概念单一：
            - 实体或实体之间的联系都用关系表示
            - 用户的观点里，数据的逻辑结构就是表
        2. 关系必须是规范化的关系
            - 指在关系模型中，每一个关系模式要满足一定的要求或者称为规范条件
            - 其最基本的要求是每一个分量是一个不可分的数据项，也就是说，不允许表中还有表。
        3. 用户对数据的检索操作不过是从原来的表中得到一张新的表
            - 在用户眼中，无论是原始数据还是结果数据，都是同一种数据结构——二维表。
            - 数据操作是集合操作，即操作对象和操作结果都是若干元组的集合，而不象非关系模型中那样单记录的操作方式。
                - 把存取路径向用户隐藏起来，提高了数据的独立性。

### 4.3 数据抽象过程

-   把现实世界中的客观对象抽象为概念模型；把概念模型转换为某个 DBMS 支持的数据模型。
    ![Img](./FILES/01.%20数据库基本概念.md/img-20230307111706.png)

-   一是概念模型
    -   （也称信息模型，用于信息世界的建模），它是按用户的观点来对数据和信息建模，主要用于数据库设计。这类模型强调其语义表达能力，要能够较方便、直接地表达应用中的各种语义知识，这类模型应为概念简单、清晰、易于用户理解，是用户和数据库设计人员之间进行交流的语言。
-   二是数据模型
    -   （如层次、网状、关系模型，用于机器世界），它是按计算机系统的观点对数据建模，主要用于 DBMS 的实现。这类模型通常需要有严格的形式化定义，而且常常会加上一些限制或规定，以便于机器上的实现。还通常有一组严格定义了语法和语义的语言，人们可以使用它来定义、操纵数据库中的数据。
-   数据模型的三要素
    -   （1） 数据结构
        -   数据结构是所研究的对象类型（Object Type）的集合。这些对象是数据库的组成部分。一般可分为两类：一类是与数据类型、内容、性质有关的对象，如网状模型中的数据项、记录，关系模型中的属性、关系等；一类是与数据之间联系有关的对象，如网状模型中的系型（Set Type）等。
    -   （2） 数据操作
        -   数据操作是指对数据库中各种对象（型）的实例（值）允许执行的操作的集合。数据库主要有检索和更新（插入、删除、修改）两大类操作。
        -   数据结构是对系统静态特性的描述，数据操作是对系统动态特性的描述。
    -   （3） 数据的约束条件
        -   数据的约束条件是完整性规则的集合。完整性规则是给定的数据模型中数据及其联系所具有的制约和依存规则，用以限定符合数据模型的数据状态以及状态的变化，以保证数据的正确、有效、相容。

### 4.4 数据模型的层次

-   **概念数据模型**（_Conceptual Data Model_），也称概念模型或信息模型。它是面向用户的模型，是现实世界到机器世界的一个中间层次。其基本特征是按用户观点对信息进行建模，与具体 DBMS 无关。
-   **逻辑数据模型**（_Logical Data Model_），也称结构数据模型，其特征是按计算机系统的观点对数据建模，服务于 DBMS 的应用实现。结构化数据模型包括：层次模型、网状模型、关系模型等。
-   **物理数据模型**（_Physical Data Model_），用于描述数据在存储介质上的组织结构，它与具体 DBMS 有关，也与操作系统和硬件有关，是物理层次上的数据模型。

### 4.5 概念数据模型

#### 概念模型的表示方法

-   实体－联系方法（E-R 方法）
    -   用 E-R 图来描述现实世界的概念模型
    -   E-R 方法也称为 E-R 模型
-   UML（统一建模语言）

#### E-R 模型三要素

-   **实体**（Entity）。实体是指客观存在并可相互区别的事物。实体可以是人、事或物，也可以是抽象的概念。如一件商品、一个客户、一份订单等都是实体。
-   **属性**（Attribute）。实体通常有若干特征，每个特征称为实体的一个属性。属性刻画了实体在某方面的特性。例如，商品实体的属性可以有商品编号、商品类别、商品名称、生产商等。
-   **联系**（Relationship）。现实世界中事物之间的联系反映在 E-R 模型中就是**实体间的联系**。例如，订单就是客户和商品之间的联系。

#### 绘制ER图的基本原则和方法
绘制ER图（实体关系图）的基本原则和方法如下：

1.  确定实体：从业务角度出发，确定需要记录的实体。实体应该是业务中的对象，比如“学生”、“教师”、“课程”等等。
    
2.  确定属性：确定每个实体需要记录的属性，例如学生实体需要记录学生姓名、学号、性别等等。
    
3.  确定实体间关系：确定实体之间的关系，包括一对一、一对多、多对多等等。
    
4.  绘制ER图：根据实体和实体之间的关系，绘制ER图。
    

绘制ER图的具体方法如下：

1.  使用==矩形==表示实体，矩形中写上实体名称。

2.  在矩形上方或下方写上实体的主键，主键是唯一标识实体的属性。

3.  使用==菱形==表示实体间的关系，菱形中写上关系名称。

4.  在关系的两端使用实体的名称或者主键表示实体之间的关系，如1对1、1对多、多对多等。

5.  如果需要标识属性，可以在关系之间使用==箭头==表示属性所属的实体。

6.  对于多对多的关系，需要建立一个连接表，该连接表包含连接实体的主键。

7.  ER图应该尽量简洁明了，不要过于复杂。在绘制过程中，可以使用标注等方式辅助说明。


绘制ER图是设计数据库的重要步骤，通过合理的ER图设计可以使得数据库的结构清晰明了，方便数据的管理和维护。

#### 实体型和实体值

-   实体型（Entity Type）是指对某一类数据结构和特征的描述。通常实体型由实体名和属性名的集合来抽象和刻画同类实体。
    -   例如，商品(商品编号，商品类别，商品名称，生产商，品牌，单价，库存量，保质期)是一个实体型。
-   实体值（Entity Value）是实体型的内容，由描述实体的各个属性值组成。
    -   例如，(50020003，体育用品，足球，美好，65，美好体育用品公司，20，2000-1-1)是实体值。

#### 联系的分类

![Img](./FILES/01.%20数据库基本概念.md/img-20230307113414.png)

-   1 对 1 联系
    -   定义：若对于实体集 A 中的每一个实体，实体集 B 中至多有一个实体与之联系，反之亦然，则称实体集 A 与实体集 B 具有一对一联系，记为 1:1。
-   1 对多联系
    -   定义：若对于实体集 A 中的每一个实体，实体集 B 中有 n 个实体(n≥0)与之联系，反之，对于实体集 B 中的每一个实体，实体集 A 中至多只有一个实体与之联系，则称实体集 A 与实体集 B 具有一对多联系，记为 1:n
-   多对多联系
    -   定义：若对于实体集 A 中的每一个实体，实体集 B 中有 n 个实体(n≥0)与之联系，反之，对于实体集 B 中的每一个实体，实体集 A 中也有 m 个实体(m≥0)与之联系，则称实体集 A 与实体集 B 具有多对多联系，记为 m:n

### 4.6 逻辑数据模型

逻辑数据模型是严格定义的一组概念的集合。
三要素：数据结构、数据操作、数据完整性约束。

#### 数据结构

-   数据结构是对系统静态特性的描述，主要描述数据库组成对象以及对象之间的联系。
-   数据结构是刻画数据模型最重要的方面。因此在数据库系统中，通常按照其数据结构的类型来命名数据模型。

#### 数据操作

-   数据操作指对数据库中各种对象（型）的实例（值）允许执行的操作及有关的操作规则，它是对数据库动态特性的描述。
-   数据库中的数据操作主要分为查询、更新两大类，其中数据更新主要是指对数据记录的增、删、改。
-   数据模型需要定义这些操作的语义、操作符号、操作规则及实现操作的相关语句。

#### 数据完整性约束

-   完整性约束是数据的一组完整性规则的集合。
-   <span style="color: rgb(255, 41, 65);">完整性规则</span>是给定的数据模型中数据及其联系所具有的制约和存储规则，用以限定符合数据模型的数据库状态以及状态的变化，保证数据的正确、有效、相容。

-   最常用的是关系模型

#### 关系模型三要素

（1）数据结构：关系模型中基本的数据结构是表格，关系模型使用二维表来表示实体及其联系。
（2）数据操作：关系模型的数据操作主要包括查询和更新。关系数据操作具有两个显著特点：一是关系操作是集合操作，即操作的对象和结果均为集合；二是关系模型将操作中的存取路径向用户屏蔽起来，用户只要说明做什么，而不必指出怎样做。
（3）数据完整性约束：对关系模型中的数据操作必须满足关系完整性约束规则。关系完整性约束规则包括三类：实体完整性、参照完整性和用户定义完整性。
