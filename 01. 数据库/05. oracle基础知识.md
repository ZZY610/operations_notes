# oracle基础知识
关系型数据库管理系统RDBMS。

## Oracle基本组件

1. **实例（Instance）：** 实例是数据库在内存中的运行时表示。 Oracle数据库的每个运行实例都是一个 **独立的内存和进程集合** ，用于处理客户端连接、查询解析、执行、缓存等。
    - 一个数据库可以有**一个或多个**实例。
    - 一个实例只能有一个SGA，但可以有多个PGA。

2. **数据库（Database）：** 数据库是物理上的数据存储，包括表、索引、存储过程等对象。每个数据库都有一个唯一的名称。

    - **表空间（Tablespace）：** 表空间是数据库中的逻辑存储单元，它包含了一个或多个数据文件。不同的表空间可以用于存储不同类型的数据。

    - **数据文件（Data Files）：** 数据文件是物理存储设备上的文件，用于存储表、索引和其他对象的数据。

    - **控制文件（Control Files）：** 控制文件是数据库的元数据文件，记录了数据库的结构和状态信息，如数据库名称、日志文件信息等。

    - **重做日志文件（Redo Log Files）：** 日志文件用于记录数据库的变更操作，以支持恢复和回滚。它包括重做日志和归档日志。

3. **参数文件（Parameter Files）：** 参数文件包含数据库配置参数的设置，如内存分配、连接数限制等。

4. **会话（Session）：** 会话是用户与数据库之间的逻辑上的交互通道，它可以执行SQL查询、事务等操作。

5. **连接（connection）：** 物理上建立的通信通道，用于在客户端和数据库服务器之间传输数据。

5. **SGA（System Global Area）：** SGA是实例的内存区域，用于缓存数据块、SQL查询计划、共享池等。它包括缓冲区高速缓存、共享池、重做缓冲区等。

6. **PGA（Program Global Area）：** PGA是每个用户或进程专有的内存区域，用于存储会话数据、变量、排序等。

7. **监听器（Listener）：** 监听器负责监听来自客户端的连接请求，将请求分配给适当的数据库实例。

8. **归档日志文件（Archiving）：** 归档是将数据库事务日志复制到归档日志文件中，以便支持数据库恢复和备份。

- **一个实例通常管理一个数据库**。一个实例负责管理特定数据库的内存、进程、缓存等方面的操作。

- **一个数据库可以被多个实例连接**。比如高可用性或负载均衡。多个实例可以连接到同一个数据库，以便在某个实例出现故障时，其他实例可以继续提供服务。

### 实例
实例（Instance）： 实例是数据库在内存中运行时的一个副本，它是由**后台进程和内存结构**组成，用于处理用户请求、管理缓存、执行查询等。实例在数据库启动时被创建，并且会在数据库关闭时被销毁。

实例的创建和销毁不是基于连接（connection）的开启和关闭。无论数据库是否被连接，实例都在后台运行，负责管理数据库的运行时操作。

想象一下你有一本书，这本书就是你的数据库。然后，你打开这本书，开始阅读，做笔记，甚至在书上做一些标记。这本书在你阅读和使用的时候，就好像是一个数据库的实例。

在这个类比中，这本书就代表了你的数据库，而当你打开它并开始与书中的内容互动时，就好比你创建了一个数据库实例。这个实例是临时存在的，只在你正在使用书本时才存在，当你关闭书本（关闭实例）时，它就不再存在了。

实例是数据库在内存中的运行状态，它包含了一些特殊的“读写记忆”，就像是你在书中标记的内容。每当你需要在书上做点什么，你都必须先打开书本（启动实例），然后进行操作。而当你完成了所有操作，关上书本（关闭实例）时，这个实例就结束了。

所以，Oracle数据库的实例就是在你使用数据库时，数据库在内存中的临时“复制”，它帮助你管理并执行你的操作，但在你不使用它时，它是不存在的。    

### SGA
SGA就像是数据库的大脑，它是一块内存区域，用于存储数据库的重要信息和共享数据。这些信息包括已经被读取的数据、执行过的查询计划、缓存数据等等。SGA帮助数据库更快地访问经常使用的数据，就像是把书本中常用的页码书签在脑海中记住，这样你就不用反复翻页来找到它们。

想象一下，你正在读一本书，而书的某几页内容你总是要翻阅。而为了不用每次都找到那几页，你决定在书本上做些记号，标记出来。这些记号就像是SGA，它们帮助你快速找到你感兴趣的内容，而不必每次都从头翻起。

类似地，SGA在数据库中存储着经常被访问的数据和信息，这些数据被缓存在内存中，这样数据库就可以更快地检索和处理它们，而不必每次都从磁盘读取。

总之，SGA是Oracle数据库的“记忆”，它存储着重要的数据和信息，使数据库能够高效地工作，就像是在书本中标记常用页码一样方便。

### PGA
PGA就像是你自己在读书时的一张便笺，用来做一些临时的、个人的笔记。它是每个用户（或会话）专用的内存区域，用于存储与其相关的操作数据，如正在执行的查询、变量值等。每个用户都有自己的PGA，就像每个读者都有自己的便笺来记录个人的想法。

假设你和朋友一起读书，但你们希望记下自己的思考和笔记，以免混淆。所以，你们每个人都准备了一本小本子，用来写下自己的想法、问题和答案。这些小本子就像是每个人的PGA，它们存储着个人的笔记和信息，而不影响其他人的阅读。

同样地，PGA在数据库中为每个用户（或会话）保留了一个私有的内存区域，用于存储正在进行的操作的数据，如临时变量、查询计划等。这确保了每个用户的操作都不会互相干扰，就像每个人的笔记本都是私密的一样。

总之，PGA是数据库中每个用户独享的内存区域，就像是在读书时每个人都有自己的便笺来记录个人的想法和笔记。

### 重做日志文件和归档日志文件
归档日志文件（Archived Redo Log Files）和重做日志文件（Redo Log Files）是 Oracle 数据库中用于数据恢复和持久性的重要组成部分。

**重做日志文件（Redo Log Files）：**
- 重做日志文件是一种循环记录，用于记录数据库发生的所有变更操作（如插入、更新、删除）。
- 每个数据库实例都有一组重做日志文件，这些文件以循环方式使用，当写满后，会重新覆盖最旧的重做日志文件。
- 重做日志文件的主要作用是在数据库崩溃或异常关闭时，将未提交的事务的变更操作重放（replay）到数据库中，确保数据的一致性和完整性。
- 它们对于恢复数据到崩溃前的状态以及保障事务的原子性、持久性和一致性非常重要。

**归档日志文件（Archived Redo Log Files）：**
- 归档日志文件是重做日志文件的备份，用于长期保存数据库的变更历史。
- 当一个重做日志文件被写满后，它会被标记为“需要归档”，然后将其内容复制到归档目录中的归档日志文件中。
- 归档日志文件的保存允许数据库管理员将数据库还原到特定时间点的状态，也用于备份和恢复策略。
- 归档日志文件对于长期数据保留、灾难恢复、数据分析和报表等场景非常重要。

重做日志文件用于保障数据库的一致性和恢复，而归档日志文件则用于长期保存数据库的变更历史，以及支持备份、恢复和灾难恢复需求。


## 数据字典
Oracle数据库中的数据字典是一个特殊的数据库对象集合，它包含了有关数据库的元数据信息，包括表、视图、索引、列、用户、权限等。数据字典充当了数据库内部的目录和文档，用于描述和管理数据库中的对象和配置。以下是有关Oracle数据字典的详细解释：

1. **元数据信息**：数据字典存储了有关数据库内部对象和配置的元数据信息。这些信息包括了数据库的结构和组件，例如表、索引、视图、列、约束、用户、角色、权限、触发器等。

2. **系统级别和用户级别**：数据字典分为系统级别和用户级别。系统级别数据字典包含了有关整个数据库的元数据信息，通常由数据库管理员（DBA）访问。用户级别数据字典包含了与当前用户相关的元数据信息，以及用户有权限访问的其他用户对象的信息。

3. **数据字典视图**：数据字典信息通常通过一组特殊的数据库表和视图来表示，这些表和视图以"DBA_"、"ALL_"和"USER_"为前缀，分别用于系统级别、全局级别和用户级别的元数据查询。例如，`DBA_TABLES`、`ALL_TABLES`和`USER_TABLES`分别包含了有关表的信息。

4. **查询和管理工具**：数据字典允许数据库管理员和开发人员查询和管理数据库对象的结构和配置。它们是数据库管理工具和查询优化器的关键信息源。

5. **维护和安全性**：数据字典中存储的信息是关于数据库的关键，因此需要特殊的维护和安全措施来保护这些信息。只有经过授权的用户才能访问数据字典信息，通常通过数据库角色和权限来控制访问。

6. **数据库优化**：数据库查询优化器可以使用数据字典信息来生成和选择执行计划，以提高查询性能。了解表、索引、统计信息等元数据有助于优化器选择最佳查询执行路径。

7. **诊断和故障排除**：在故障排除和性能分析过程中，数据字典信息对于分析数据库问题和确定问题原因非常有用。数据库管理员可以使用数据字典来查找表空间的使用情况、查看数据库对象的状态等。

总之，Oracle数据字典是一个关键的数据库组件，它存储了关于数据库对象和配置的元数据信息，为数据库管理、查询优化、安全性、维护和故障排除提供了重要的支持。它是Oracle数据库内部的一个重要工具，有助于管理和维护复杂的数据库系统。

### 数据字典视图
Oracle数据库中的数据字典视图用于存储有关数据库对象和元数据的信息。这些视图提供了对数据库结构和配置的详细了解，可用于查询表、视图、索引、列、约束、用户、角色、权限等方面的信息。以下是一些常见的Oracle数据字典视图以及它们的功能：

1. **DBA_TABLES**：包含有关数据库中**所有表**的信息，包括表名、所属表空间、列数等。通常由数据库管理员（DBA）访问。

2. **ALL_TABLES**：包含有关 **当前用户** 具有访问权限的所有表的信息，包括表名、所属表空间、列数等。

3. **USER_TABLES**：包含有关当前用户拥有的表的信息，包括表名、所属表空间、列数等。

4. **DBA_VIEWS**：包含有关数据库中所有视图的信息，包括视图名、所属者、查询定义等。

5. **ALL_VIEWS**：包含有关当前用户具有访问权限的所有视图的信息，包括视图名、所属者、查询定义等。

6. **USER_VIEWS**：包含有关当前用户拥有的视图的信息，包括视图名、查询定义等。

7. **DBA_INDEXES**：包含有关数据库中所有索引的信息，包括索引名、所属表、列名等。

8. **ALL_INDEXES**：包含有关当前用户具有访问权限的所有索引的信息，包括索引名、所属表、列名等。

9. **USER_INDEXES**：包含有关当前用户拥有的索引的信息，包括索引名、所属表、列名等。

10. **DBA_CONSTRAINTS**：包含有关数据库中所有约束（主键、外键、唯一性约束等）的信息，包括约束名、约束类型、所属表等。

11. **ALL_CONSTRAINTS**：包含有关当前用户具有访问权限的所有约束的信息，包括约束名、约束类型、所属表等。

12. **USER_CONSTRAINTS**：包含有关当前用户拥有的约束的信息，包括约束名、约束类型、所属表等。

13. **DBA_TAB_COLUMNS**：包含有关数据库中所有表的列的信息，包括列名、数据类型、长度等。

14. **ALL_TAB_COLUMNS**：包含有关当前用户具有访问权限的所有表的列的信息，包括列名、数据类型、长度等。

15. **USER_TAB_COLUMNS**：包含有关当前用户拥有的表的列的信息，包括列名、数据类型、长度等。

16. **DBA_USERS**：包含有关数据库中所有用户的信息，包括用户名、默认表空间、临时表空间等。

17. **ALL_USERS**：包含有关当前数据库实例中的所有用户的信息。

18. **DBA_ROLES**：包含有关数据库中所有角色的信息，包括角色名、角色类型等。

19. **ALL_ROLES**：包含有关当前用户具有访问权限的所有角色的信息。

20. **DBA_TAB_PRIVS**：包含有关数据库中表的权限授予信息，包括授权者、受权者、权限等。

21. **dba_data_files**：存储数据库文件信息，包括每个数据文件的大小，路径，块大小，是否只读，是否存在碎片等信息。

这些是一些常见的Oracle数据字典视图，还有其他视图和表，用于存储数据库的元数据信息。



## 系统级命令

1. **启动和关闭数据库实例**：
   - `startup`: 启动数据库实例。
   - `shutdown`: 关闭数据库实例。

2. **管理归档日志**：
   - `ARCHIVE LOG`: 将归档日志文件保存到归档目录中。
   - `LOG SWITCH`: 强制切换日志文件，用于手动触发归档。

3. **数据库参数设置**：
   - `ALTER SYSTEM`: 修改数据库全局参数。
   - `SHOW PARAMETER`: 显示数据库参数的当前值。

4. **备份和恢复**：
   - `RMAN`（Recovery Manager）: 用于备份和恢复数据库。
   - `BACKUP DATABASE`: 备份整个数据库。
   - `RESTORE DATABASE`: 恢复整个数据库。
   - `RECOVER DATABASE`: 在备份后恢复数据库。

5. **数据库空间管理**：
   - `ALTER TABLESPACE`: 修改表空间的属性。
   - `EXTEND`: 增加数据文件的大小。
   - `RESIZE`: 调整数据文件的大小。

6. **用户和权限管理**：
   - `CREATE USER`: 创建新用户。
   - `ALTER USER`: 修改用户属性。
   - `DROP USER`: 删除用户。
   - `GRANT`: 授予用户或角色对数据库对象的访问权限。
   - `REVOKE`: 撤销对数据库对象的权限。

7. **角色和权限管理**：
   - `CREATE ROLE`: 创建角色。
   - `ALTER ROLE`: 修改角色属性。
   - `DROP ROLE`: 删除角色。

8. **审计和安全性**：
   - `AUDIT`: 启用审计功能，跟踪数据库操作。
   - `NOAUDIT`: 停用审计功能。
   - `ALTER USER` 和 `ALTER DATABASE`: 设置安全选项，如口令策略、身份验证方法等。

9. **监控和性能优化**：
   - `AWR`（Automatic Workload Repository）: 收集性能数据并生成报告。
   - `ASH`（Active Session History）: 用于监控活动会话的历史信息。
   - `V$` 视图: 查询数据库的动态性能和状态信息。

10. **数据导入和导出**：
    - `EXP` 和 `IMP`: 用于导出和导入数据库对象和数据。
    - `DATA PUMP`: 使用 `EXPDP` 和 `IMPDP` 进行更高效的导入和导出。

这些系统级命令用于管理和维护Oracle数据库实例、配置和性能。数据库管理员使用这些命令来确保数据库的正常运行、安全性和高性能。具体的命令和用法可能会因Oracle数据库的版本和配置而有所不同，因此请查阅相关文档和手册以获取详细信息。